{
  "cells": [
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "GzGzqWHefprZ"
      },
      "source": [
        "\n",
        "# **Insurance Claim Severity Prediction Project**\n",
        "---\n",
        "#Advanced Interpretability of Tree Ensembles: SHAP Analysis\n",
        "\n",
        "*Problem Description:*\n",
        "\n",
        "This project focuses on predicting insurance claim severity using an advanced tree-based model (XGBoost). Beyond achieving high predictive accuracy, the project emphasizes model interpretability using SHAP values to understand how each feature influences risk. The analysis includes global feature importance, local case explanations, and fairness checks to ensure the model behaves reliably for real-world insurance decision-making.\n",
        "\n",
        "\n",
        "\n",
        "*problem statement:*\n",
        "\n",
        "Insurance companies must accurately estimate claim severity to manage financial risk and price policies effectively. Traditional models often behave like “black boxes,” making it difficult to understand why certain claims receive higher predictions. This project aims to build an accurate prediction model while providing transparent explanations using SHAP, enabling data-driven and interpretable decisions."
      ],
      "id": "GzGzqWHefprZ"
    },
    {
      "cell_type": "code",
      "execution_count": 81,
      "metadata": {
        "id": "VFSrB4uTfprc"
      },
      "outputs": [],
      "source": [
        "\n",
        "# !pip install xgboost shap joblib scikit-learn pandas matplotlib\n",
        "\n",
        "import os\n",
        "os.makedirs('artifacts', exist_ok=True)\n",
        "os.makedirs('plots', exist_ok=True)\n",
        "os.makedirs('reports', exist_ok=True)\n",
        "\n",
        "import warnings\n",
        "warnings.filterwarnings('ignore')\n",
        "\n",
        "import numpy as np\n",
        "import pandas as pd\n",
        "from sklearn.model_selection import train_test_split\n",
        "from sklearn.compose import ColumnTransformer\n",
        "from sklearn.pipeline import Pipeline\n",
        "from sklearn.preprocessing import StandardScaler, OneHotEncoder\n",
        "from sklearn.impute import SimpleImputer\n",
        "from sklearn.metrics import mean_squared_error, mean_absolute_error, r2_score\n",
        "import joblib\n",
        "import matplotlib.pyplot as plt\n",
        "import xgboost as xgb\n",
        "import shap\n"
      ],
      "id": "VFSrB4uTfprc"
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "LVdDCKMIfprd"
      },
      "source": [
        "## 1. Load the data\n",
        "\n",
        "Update `data_path` if your CSV has a different name. The notebook expects `insurance_claims_large.csv` in the same folder as the notebook."
      ],
      "id": "LVdDCKMIfprd"
    },
    {
      "cell_type": "code",
      "execution_count": 82,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/",
          "height": 244
        },
        "id": "eWBt7p7Tfprd",
        "outputId": "8f5e5e6e-ed30-4337-d762-ff52925eb80e"
      },
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "Loaded dataset with shape: (1000, 7)\n"
          ]
        },
        {
          "output_type": "execute_result",
          "data": {
            "text/plain": [
              "   age gender  vehicle_age  vehicle_value  prior_claims  policy_deductible  \\\n",
              "0   56      M            5          34153             5               1500   \n",
              "1   69      M            7          31164             1               1100   \n",
              "2   46      F            9          39910             1                700   \n",
              "3   32      M            3          36584             3                300   \n",
              "4   60      M            8          30986             3               1300   \n",
              "\n",
              "   claim_severity  \n",
              "0    12503.184580  \n",
              "1     5640.498662  \n",
              "2     7517.222866  \n",
              "3     7590.954438  \n",
              "4     9069.769492  "
            ],
            "text/html": [
              "\n",
              "  <div id=\"df-395fb0a4-5643-4bca-b2ce-6a0895ae7f07\" class=\"colab-df-container\">\n",
              "    <div>\n",
              "<style scoped>\n",
              "    .dataframe tbody tr th:only-of-type {\n",
              "        vertical-align: middle;\n",
              "    }\n",
              "\n",
              "    .dataframe tbody tr th {\n",
              "        vertical-align: top;\n",
              "    }\n",
              "\n",
              "    .dataframe thead th {\n",
              "        text-align: right;\n",
              "    }\n",
              "</style>\n",
              "<table border=\"1\" class=\"dataframe\">\n",
              "  <thead>\n",
              "    <tr style=\"text-align: right;\">\n",
              "      <th></th>\n",
              "      <th>age</th>\n",
              "      <th>gender</th>\n",
              "      <th>vehicle_age</th>\n",
              "      <th>vehicle_value</th>\n",
              "      <th>prior_claims</th>\n",
              "      <th>policy_deductible</th>\n",
              "      <th>claim_severity</th>\n",
              "    </tr>\n",
              "  </thead>\n",
              "  <tbody>\n",
              "    <tr>\n",
              "      <th>0</th>\n",
              "      <td>56</td>\n",
              "      <td>M</td>\n",
              "      <td>5</td>\n",
              "      <td>34153</td>\n",
              "      <td>5</td>\n",
              "      <td>1500</td>\n",
              "      <td>12503.184580</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>1</th>\n",
              "      <td>69</td>\n",
              "      <td>M</td>\n",
              "      <td>7</td>\n",
              "      <td>31164</td>\n",
              "      <td>1</td>\n",
              "      <td>1100</td>\n",
              "      <td>5640.498662</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>2</th>\n",
              "      <td>46</td>\n",
              "      <td>F</td>\n",
              "      <td>9</td>\n",
              "      <td>39910</td>\n",
              "      <td>1</td>\n",
              "      <td>700</td>\n",
              "      <td>7517.222866</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>3</th>\n",
              "      <td>32</td>\n",
              "      <td>M</td>\n",
              "      <td>3</td>\n",
              "      <td>36584</td>\n",
              "      <td>3</td>\n",
              "      <td>300</td>\n",
              "      <td>7590.954438</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>4</th>\n",
              "      <td>60</td>\n",
              "      <td>M</td>\n",
              "      <td>8</td>\n",
              "      <td>30986</td>\n",
              "      <td>3</td>\n",
              "      <td>1300</td>\n",
              "      <td>9069.769492</td>\n",
              "    </tr>\n",
              "  </tbody>\n",
              "</table>\n",
              "</div>\n",
              "    <div class=\"colab-df-buttons\">\n",
              "\n",
              "  <div class=\"colab-df-container\">\n",
              "    <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-395fb0a4-5643-4bca-b2ce-6a0895ae7f07')\"\n",
              "            title=\"Convert this dataframe to an interactive table.\"\n",
              "            style=\"display:none;\">\n",
              "\n",
              "  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 -960 960 960\">\n",
              "    <path d=\"M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z\"/>\n",
              "  </svg>\n",
              "    </button>\n",
              "\n",
              "  <style>\n",
              "    .colab-df-container {\n",
              "      display:flex;\n",
              "      gap: 12px;\n",
              "    }\n",
              "\n",
              "    .colab-df-convert {\n",
              "      background-color: #E8F0FE;\n",
              "      border: none;\n",
              "      border-radius: 50%;\n",
              "      cursor: pointer;\n",
              "      display: none;\n",
              "      fill: #1967D2;\n",
              "      height: 32px;\n",
              "      padding: 0 0 0 0;\n",
              "      width: 32px;\n",
              "    }\n",
              "\n",
              "    .colab-df-convert:hover {\n",
              "      background-color: #E2EBFA;\n",
              "      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n",
              "      fill: #174EA6;\n",
              "    }\n",
              "\n",
              "    .colab-df-buttons div {\n",
              "      margin-bottom: 4px;\n",
              "    }\n",
              "\n",
              "    [theme=dark] .colab-df-convert {\n",
              "      background-color: #3B4455;\n",
              "      fill: #D2E3FC;\n",
              "    }\n",
              "\n",
              "    [theme=dark] .colab-df-convert:hover {\n",
              "      background-color: #434B5C;\n",
              "      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n",
              "      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n",
              "      fill: #FFFFFF;\n",
              "    }\n",
              "  </style>\n",
              "\n",
              "    <script>\n",
              "      const buttonEl =\n",
              "        document.querySelector('#df-395fb0a4-5643-4bca-b2ce-6a0895ae7f07 button.colab-df-convert');\n",
              "      buttonEl.style.display =\n",
              "        google.colab.kernel.accessAllowed ? 'block' : 'none';\n",
              "\n",
              "      async function convertToInteractive(key) {\n",
              "        const element = document.querySelector('#df-395fb0a4-5643-4bca-b2ce-6a0895ae7f07');\n",
              "        const dataTable =\n",
              "          await google.colab.kernel.invokeFunction('convertToInteractive',\n",
              "                                                    [key], {});\n",
              "        if (!dataTable) return;\n",
              "\n",
              "        const docLinkHtml = 'Like what you see? Visit the ' +\n",
              "          '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n",
              "          + ' to learn more about interactive tables.';\n",
              "        element.innerHTML = '';\n",
              "        dataTable['output_type'] = 'display_data';\n",
              "        await google.colab.output.renderOutput(dataTable, element);\n",
              "        const docLink = document.createElement('div');\n",
              "        docLink.innerHTML = docLinkHtml;\n",
              "        element.appendChild(docLink);\n",
              "      }\n",
              "    </script>\n",
              "  </div>\n",
              "\n",
              "\n",
              "    <div id=\"df-4d2dde4f-8f84-4605-91e1-83023fb9594f\">\n",
              "      <button class=\"colab-df-quickchart\" onclick=\"quickchart('df-4d2dde4f-8f84-4605-91e1-83023fb9594f')\"\n",
              "                title=\"Suggest charts\"\n",
              "                style=\"display:none;\">\n",
              "\n",
              "<svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n",
              "     width=\"24px\">\n",
              "    <g>\n",
              "        <path d=\"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z\"/>\n",
              "    </g>\n",
              "</svg>\n",
              "      </button>\n",
              "\n",
              "<style>\n",
              "  .colab-df-quickchart {\n",
              "      --bg-color: #E8F0FE;\n",
              "      --fill-color: #1967D2;\n",
              "      --hover-bg-color: #E2EBFA;\n",
              "      --hover-fill-color: #174EA6;\n",
              "      --disabled-fill-color: #AAA;\n",
              "      --disabled-bg-color: #DDD;\n",
              "  }\n",
              "\n",
              "  [theme=dark] .colab-df-quickchart {\n",
              "      --bg-color: #3B4455;\n",
              "      --fill-color: #D2E3FC;\n",
              "      --hover-bg-color: #434B5C;\n",
              "      --hover-fill-color: #FFFFFF;\n",
              "      --disabled-bg-color: #3B4455;\n",
              "      --disabled-fill-color: #666;\n",
              "  }\n",
              "\n",
              "  .colab-df-quickchart {\n",
              "    background-color: var(--bg-color);\n",
              "    border: none;\n",
              "    border-radius: 50%;\n",
              "    cursor: pointer;\n",
              "    display: none;\n",
              "    fill: var(--fill-color);\n",
              "    height: 32px;\n",
              "    padding: 0;\n",
              "    width: 32px;\n",
              "  }\n",
              "\n",
              "  .colab-df-quickchart:hover {\n",
              "    background-color: var(--hover-bg-color);\n",
              "    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);\n",
              "    fill: var(--button-hover-fill-color);\n",
              "  }\n",
              "\n",
              "  .colab-df-quickchart-complete:disabled,\n",
              "  .colab-df-quickchart-complete:disabled:hover {\n",
              "    background-color: var(--disabled-bg-color);\n",
              "    fill: var(--disabled-fill-color);\n",
              "    box-shadow: none;\n",
              "  }\n",
              "\n",
              "  .colab-df-spinner {\n",
              "    border: 2px solid var(--fill-color);\n",
              "    border-color: transparent;\n",
              "    border-bottom-color: var(--fill-color);\n",
              "    animation:\n",
              "      spin 1s steps(1) infinite;\n",
              "  }\n",
              "\n",
              "  @keyframes spin {\n",
              "    0% {\n",
              "      border-color: transparent;\n",
              "      border-bottom-color: var(--fill-color);\n",
              "      border-left-color: var(--fill-color);\n",
              "    }\n",
              "    20% {\n",
              "      border-color: transparent;\n",
              "      border-left-color: var(--fill-color);\n",
              "      border-top-color: var(--fill-color);\n",
              "    }\n",
              "    30% {\n",
              "      border-color: transparent;\n",
              "      border-left-color: var(--fill-color);\n",
              "      border-top-color: var(--fill-color);\n",
              "      border-right-color: var(--fill-color);\n",
              "    }\n",
              "    40% {\n",
              "      border-color: transparent;\n",
              "      border-right-color: var(--fill-color);\n",
              "      border-top-color: var(--fill-color);\n",
              "    }\n",
              "    60% {\n",
              "      border-color: transparent;\n",
              "      border-right-color: var(--fill-color);\n",
              "    }\n",
              "    80% {\n",
              "      border-color: transparent;\n",
              "      border-right-color: var(--fill-color);\n",
              "      border-bottom-color: var(--fill-color);\n",
              "    }\n",
              "    90% {\n",
              "      border-color: transparent;\n",
              "      border-bottom-color: var(--fill-color);\n",
              "    }\n",
              "  }\n",
              "</style>\n",
              "\n",
              "      <script>\n",
              "        async function quickchart(key) {\n",
              "          const quickchartButtonEl =\n",
              "            document.querySelector('#' + key + ' button');\n",
              "          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.\n",
              "          quickchartButtonEl.classList.add('colab-df-spinner');\n",
              "          try {\n",
              "            const charts = await google.colab.kernel.invokeFunction(\n",
              "                'suggestCharts', [key], {});\n",
              "          } catch (error) {\n",
              "            console.error('Error during call to suggestCharts:', error);\n",
              "          }\n",
              "          quickchartButtonEl.classList.remove('colab-df-spinner');\n",
              "          quickchartButtonEl.classList.add('colab-df-quickchart-complete');\n",
              "        }\n",
              "        (() => {\n",
              "          let quickchartButtonEl =\n",
              "            document.querySelector('#df-4d2dde4f-8f84-4605-91e1-83023fb9594f button');\n",
              "          quickchartButtonEl.style.display =\n",
              "            google.colab.kernel.accessAllowed ? 'block' : 'none';\n",
              "        })();\n",
              "      </script>\n",
              "    </div>\n",
              "\n",
              "    </div>\n",
              "  </div>\n"
            ],
            "application/vnd.google.colaboratory.intrinsic+json": {
              "type": "dataframe",
              "variable_name": "df",
              "summary": "{\n  \"name\": \"df\",\n  \"rows\": 1000,\n  \"fields\": [\n    {\n      \"column\": \"age\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 18,\n        \"min\": 18,\n        \"max\": 79,\n        \"num_unique_values\": 62,\n        \"samples\": [\n          51,\n          18,\n          56\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"gender\",\n      \"properties\": {\n        \"dtype\": \"category\",\n        \"num_unique_values\": 2,\n        \"samples\": [\n          \"F\",\n          \"M\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"vehicle_age\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 4,\n        \"min\": 1,\n        \"max\": 14,\n        \"num_unique_values\": 14,\n        \"samples\": [\n          4,\n          1\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"vehicle_value\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 9374,\n        \"min\": 8016,\n        \"max\": 39982,\n        \"num_unique_values\": 976,\n        \"samples\": [\n          10530,\n          21057\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"prior_claims\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 1,\n        \"min\": 0,\n        \"max\": 5,\n        \"num_unique_values\": 6,\n        \"samples\": [\n          5,\n          1\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"policy_deductible\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 407,\n        \"min\": 300,\n        \"max\": 1500,\n        \"num_unique_values\": 8,\n        \"samples\": [\n          1100,\n          400\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"claim_severity\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 2972.0790942519375,\n        \"min\": 200.0,\n        \"max\": 16971.32949,\n        \"num_unique_values\": 1000,\n        \"samples\": [\n          11629.07249,\n          7129.445881\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    }\n  ]\n}"
            }
          },
          "metadata": {},
          "execution_count": 82
        }
      ],
      "source": [
        "data_path = '/content/insurance_claims_large.csv'\n",
        "if not os.path.exists(data_path):\n",
        "    raise FileNotFoundError(f\"Dataset not found at {data_path}. Please upload the CSV to the notebook folder.\")\n",
        "\n",
        "df = pd.read_csv(data_path)\n",
        "print('Loaded dataset with shape:', df.shape)\n",
        "df.head()\n"
      ],
      "id": "eWBt7p7Tfprd"
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "o0rq_mAMfpre"
      },
      "source": [
        "## 2. Quick data cleaning and feature selection\n",
        "\n",
        "Adjust `target_col` to match the notebook requirement for claim severity."
      ],
      "id": "o0rq_mAMfpre"
    },
    {
      "cell_type": "code",
      "execution_count": 83,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "mMyhw7-kfpre",
        "outputId": "e8095fd1-03fe-431c-b83e-02f33e0ec2cb"
      },
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "Predictor shape: (1000, 6)\n",
            "Numerical cols: 5 Categorical cols: 1\n"
          ]
        }
      ],
      "source": [
        "target_col = 'claim_severity'\n",
        "if target_col not in df.columns:\n",
        "    candidates = [c for c in df.columns if ('severity' in c.lower()) or ('claim' in c.lower() and 'amount' in c.lower())]\n",
        "    if len(candidates) > 0:\n",
        "        target_col = candidates[0]\n",
        "        print('Auto-detected target column:', target_col)\n",
        "    else:\n",
        "        raise ValueError('Target column claim_severity not found. Please set the correct column name in target_col.')\n",
        "\n",
        "y = df[target_col]\n",
        "X = df.drop(columns=[target_col])\n",
        "print('Predictor shape:', X.shape)\n",
        "\n",
        "numeric_cols = X.select_dtypes(include=['int64', 'float64']).columns.tolist()\n",
        "cat_cols = X.select_dtypes(include=['object', 'category']).columns.tolist()\n",
        "print('Numerical cols:', len(numeric_cols), 'Categorical cols:', len(cat_cols))\n"
      ],
      "id": "mMyhw7-kfpre"
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "kyq9bk4Afpre"
      },
      "source": [
        "## 3. Train / test split\n",
        "Use a stratify column if you want; for regression we will do a plain split."
      ],
      "id": "kyq9bk4Afpre"
    },
    {
      "cell_type": "code",
      "execution_count": 84,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "AiNgPnFyfprf",
        "outputId": "1db3d5d1-46a4-42b9-a617-c082c72548b8"
      },
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "Train shape: (800, 6) Test shape: (200, 6)\n"
          ]
        }
      ],
      "source": [
        "X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.20, random_state=42)\n",
        "print('Train shape:', X_train.shape, 'Test shape:', X_test.shape)\n"
      ],
      "id": "AiNgPnFyfprf"
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "85jbipYifprf"
      },
      "source": [
        "## 4. Preprocessing pipeline\n",
        "Numeric: impute median and scale. Categorical: impute constant and one-hot encode."
      ],
      "id": "85jbipYifprf"
    },
    {
      "cell_type": "code",
      "execution_count": 85,
      "metadata": {
        "id": "jZ1wUt1-fprf"
      },
      "outputs": [],
      "source": [
        "numeric_transformer = Pipeline(steps=[\n",
        "    ('impute', SimpleImputer(strategy='median')),\n",
        "    ('scale', StandardScaler())\n",
        "])\n",
        "categorical_transformer = Pipeline(steps=[\n",
        "    ('impute', SimpleImputer(strategy='constant', fill_value='missing')),\n",
        "    ('ohe', OneHotEncoder(sparse_output=False, handle_unknown='ignore'))\n",
        "])\n",
        "preprocessor = ColumnTransformer(transformers=[\n",
        "    ('num', numeric_transformer, numeric_cols),\n",
        "    ('cat', categorical_transformer, cat_cols)\n",
        "], remainder='drop')"
      ],
      "id": "jZ1wUt1-fprf"
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "1nutzMmqfprf"
      },
      "source": [
        "## 5. Model training\n",
        "XGBoost regressor inside a Pipeline."
      ],
      "id": "1nutzMmqfprf"
    },
    {
      "cell_type": "code",
      "execution_count": 86,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "Fp6KkSuLfprf",
        "outputId": "4941ca77-b421-4b88-81e5-00b157e0db97"
      },
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "Running RandomizedSearchCV...\n",
            "Fitting 5 folds for each of 30 candidates, totalling 150 fits\n",
            "RandomizedSearchCV tuning completed.\n",
            "\n",
            "Best parameters saved to artifacts/best_model_params.txt\n",
            "\n",
            "Fitting model...\n",
            "Training finished\n"
          ]
        }
      ],
      "source": [
        "from xgboost import XGBRegressor\n",
        "\n",
        "model = XGBRegressor(\n",
        "    n_estimators=200,\n",
        "    learning_rate=0.05,\n",
        "    max_depth=6,\n",
        "    subsample=0.8,\n",
        "    colsample_bytree=0.8,\n",
        "    random_state=42,\n",
        "    objective='reg:squarederror',\n",
        "    verbosity=0\n",
        ")\n",
        "\n",
        "pipeline = Pipeline(steps=[('preprocess', preprocessor), ('model', model)])\n",
        "# ------------------------------------------------------------\n",
        "#  RandomizedSearchCV Hyperparameter Tuning for XGBoost Model\n",
        "# ------------------------------------------------------------\n",
        "\n",
        "from sklearn.model_selection import RandomizedSearchCV\n",
        "from scipy.stats import randint, uniform\n",
        "import numpy as np\n",
        "\n",
        "# Base model inside the pipeline\n",
        "xgb_base = XGBRegressor(\n",
        "    objective='reg:squarederror',\n",
        "    random_state=42,\n",
        "    tree_method='hist'\n",
        ")\n",
        "\n",
        "pipeline = Pipeline(steps=[\n",
        "    ('preprocess', preprocessor),\n",
        "    ('model', xgb_base)\n",
        "])\n",
        "\n",
        "# Define hyperparameter search space\n",
        "param_distributions = {\n",
        "    'model__n_estimators': randint(200, 800),\n",
        "    'model__max_depth': randint(3, 10),\n",
        "    'model__learning_rate': uniform(0.01, 0.2),\n",
        "    'model__subsample': uniform(0.6, 0.4),\n",
        "    'model__colsample_bytree': uniform(0.6, 0.4),\n",
        "    'model__min_child_weight': randint(1, 10),\n",
        "    'model__gamma': uniform(0, 5)\n",
        "}\n",
        "\n",
        "# Randomized search\n",
        "random_search = RandomizedSearchCV(\n",
        "    estimator=pipeline,\n",
        "    param_distributions=param_distributions,\n",
        "    n_iter=30,              # number of random combinations\n",
        "    scoring='neg_root_mean_squared_error',\n",
        "    cv=5,\n",
        "    verbose=2,\n",
        "    random_state=42,\n",
        "    n_jobs=-1\n",
        ")\n",
        "\n",
        "print(\"Running RandomizedSearchCV...\")\n",
        "random_search.fit(X_train, y_train)\n",
        "print(\"RandomizedSearchCV tuning completed.\")\n",
        "\n",
        "# Extract best model\n",
        "best_pipeline = random_search.best_estimator_\n",
        "\n",
        "# Save best parameters\n",
        "os.makedirs('artifacts', exist_ok=True)\n",
        "with open(\"artifacts/best_model_params.txt\", \"w\") as f:\n",
        "    f.write(\"Best hyperparameters found by RandomizedSearchCV:\\n\")\n",
        "    for param, value in random_search.best_params_.items():\n",
        "        f.write(f\"{param}: {value}\\n\")\n",
        "\n",
        "print(\"\\nBest parameters saved to artifacts/best_model_params.txt\\n\")\n",
        "\n",
        "# This replaces your original model pipeline\n",
        "pipeline = best_pipeline\n",
        "\n",
        "\n",
        "print('Fitting model...')\n",
        "pipeline.fit(X_train, y_train)\n",
        "print('Training finished')\n"
      ],
      "id": "Fp6KkSuLfprf"
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "4qQpCOxMfprg"
      },
      "source": [
        "## 6. Save model and parameters\n"
      ],
      "id": "4qQpCOxMfprg"
    },
    {
      "cell_type": "code",
      "execution_count": 87,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "fxZwHjCJfprg",
        "outputId": "c8afcf5a-7788-422d-8b1f-242e03383ed7"
      },
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "Saved pipeline and parameters\n"
          ]
        }
      ],
      "source": [
        "joblib.dump(pipeline, 'artifacts/xgb_claim_severity_pipeline.joblib')\n",
        "with open('artifacts/trained_model_config.txt', 'w') as f:\n",
        "    f.write('Trained model parameters for XGBRegressor (final).\\n')\n",
        "    params = pipeline.named_steps['model'].get_params()\n",
        "    for k, v in sorted(params.items()):\n",
        "        f.write(f\"{k}: {v}\\n\")\n",
        "print('Saved pipeline and parameters')\n"
      ],
      "id": "fxZwHjCJfprg"
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "7qrBrpAGfprg"
      },
      "source": [
        "## 7. Predictions and performance\n"
      ],
      "id": "7qrBrpAGfprg"
    },
    {
      "cell_type": "code",
      "execution_count": 88,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "0hRB7rgOfprg",
        "outputId": "d686d319-732f-44b0-b350-171a266703fe"
      },
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "Saved predictions and performance report\n"
          ]
        }
      ],
      "source": [
        "y_pred = pipeline.predict(X_test)\n",
        "pd.DataFrame({'y_test': y_test, 'y_pred': y_pred}).to_csv('artifacts/predictions_test.csv', index=False)\n",
        "rmse = np.sqrt(mean_squared_error(y_test, y_pred))\n",
        "mae = mean_absolute_error(y_test, y_pred)\n",
        "r2 = r2_score(y_test, y_pred)\n",
        "with open('reports/Model_Performance.txt', 'w') as f:\n",
        "    f.write('Model performance on test set\\n')\n",
        "    f.write(f'RMSE: {rmse:.6f}\\n')\n",
        "    f.write(f'MAE: {mae:.6f}\\n')\n",
        "    f.write(f'R2: {r2:.6f}\\n')\n",
        "print('Saved predictions and performance report')"
      ],
      "id": "0hRB7rgOfprg"
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "5N0nl2mzfprg"
      },
      "source": [
        "## 8. SHAP global analysis and plots\n"
      ],
      "id": "5N0nl2mzfprg"
    },
    {
      "cell_type": "code",
      "execution_count": 89,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "RPjquG_Bfprg",
        "outputId": "886561b4-475e-4c0d-93a5-6debf8e9f6e3"
      },
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "Saved SHAP artifacts\n"
          ]
        }
      ],
      "source": [
        "X_train_trans = pipeline.named_steps['preprocess'].transform(X_train)\n",
        "try:\n",
        "    cat_ohe = pipeline.named_steps['preprocess'].named_transformers_['cat'].named_steps['ohe']\n",
        "    cat_feature_names = list(cat_ohe.get_feature_names_out(cat_cols)) if len(cat_cols)>0 else []\n",
        "except Exception:\n",
        "    cat_feature_names = []\n",
        "feature_names = cat_feature_names + numeric_cols\n",
        "explainer = shap.TreeExplainer(pipeline.named_steps['model'])\n",
        "shap_values = explainer.shap_values(X_train_trans)\n",
        "mean_abs_shap = np.mean(np.abs(shap_values), axis=0)\n",
        "pd.DataFrame({'feature': feature_names, 'mean_abs_shap': mean_abs_shap}).sort_values('mean_abs_shap', ascending=False).to_csv('artifacts/global_shap_importance.csv', index=False)\n",
        "\n",
        "plt.figure(figsize=(8,6))\n",
        "shap.summary_plot(shap_values, X_train_trans, feature_names=feature_names, plot_type='bar', show=False)\n",
        "plt.tight_layout()\n",
        "plt.savefig('plots/shap_summary_bar.png', dpi=200)\n",
        "plt.close()\n",
        "\n",
        "plt.figure(figsize=(8,6))\n",
        "shap.summary_plot(shap_values, X_train_trans, feature_names=feature_names, show=False)\n",
        "plt.tight_layout()\n",
        "plt.savefig('plots/shap_summary_beeswarm.png', dpi=200)\n",
        "plt.close()\n",
        "print('Saved SHAP artifacts')\n"
      ],
      "id": "RPjquG_Bfprg"
    },
    {
      "cell_type": "markdown",
      "source": [
        "Dependence plots for Top 5 SHAP features (safe Matplotlib)\n"
      ],
      "metadata": {
        "id": "JAqzWuzRqpDh"
      },
      "id": "JAqzWuzRqpDh"
    },
    {
      "cell_type": "code",
      "source": [
        "import matplotlib.pyplot as plt\n",
        "import numpy as np\n",
        "import pandas as pd\n",
        "\n",
        "# Use the already-loaded global shap CSV\n",
        "global_shap = pd.read_csv(\"artifacts/global_shap_importance.csv\")\n",
        "global_shap = global_shap.sort_values(\"mean_abs_shap\", ascending=False)\n",
        "top5_features = global_shap[\"feature\"].head(5).tolist()\n",
        "\n",
        "print(\"Top 5 features for dependence plots:\", top5_features)\n",
        "\n",
        "# Dependence plots directory\n",
        "os.makedirs(\"plots/dependence_plots\", exist_ok=True)\n",
        "\n",
        "# Create a DataFrame from the transformed data for easier feature access by name\n",
        "X_for_explain_df = pd.DataFrame(X_train_trans, columns=feature_names)\n",
        "# Assign shap_vals from the already calculated shap_values\n",
        "shap_vals = shap_values\n",
        "\n",
        "for feat in top5_features:\n",
        "    if feat not in X_for_explain_df.columns:\n",
        "        print(\"Skipping missing feature:\", feat)\n",
        "        continue\n",
        "\n",
        "    idx = X_for_explain_df.columns.get_loc(feat)\n",
        "    x_vals = X_for_explain_df[feat].values\n",
        "    y_vals = shap_vals[:, idx]\n",
        "\n",
        "    plt.figure(figsize=(7,5))\n",
        "    plt.scatter(x_vals, y_vals, s=10, alpha=0.6)\n",
        "    plt.xlabel(feat)\n",
        "    plt.ylabel(\"SHAP value\")\n",
        "    plt.title(f\"Dependence plot: {feat}\")\n",
        "    plt.tight_layout()\n",
        "    plt.savefig(f\"plots/dependence_plots/dependence_{feat}.png\", dpi=200)\n",
        "    plt.close()\n",
        "\n",
        "print(\"Saved global dependence plots to: plots/dependence_plots/\")"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "H-2E7HlqqAtr",
        "outputId": "6f2699b3-a9fb-47a7-ac66-3affe33a30e1"
      },
      "id": "H-2E7HlqqAtr",
      "execution_count": 90,
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "Top 5 features for dependence plots: ['vehicle_age', 'age', 'gender_M', 'gender_F', 'vehicle_value']\n",
            "Saved global dependence plots to: plots/dependence_plots/\n"
          ]
        }
      ]
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "61grdh0Nfprg"
      },
      "source": [
        "## 9. Local SHAP case studies\n"
      ],
      "id": "61grdh0Nfprg"
    },
    {
      "cell_type": "code",
      "execution_count": 91,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "WWsdfgL-fprg",
        "outputId": "4b9be7f0-1c72-4d14-f5e1-114850f7250b"
      },
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "Saved local SHAP case plots\n"
          ]
        }
      ],
      "source": [
        "preds_train = pipeline.predict(X_train)\n",
        "case_high = np.argmax(preds_train)\n",
        "case_low = np.argmin(preds_train)\n",
        "residuals_train = np.abs(y_train.values - preds_train)\n",
        "case_outlier = np.argmax(residuals_train)\n",
        "cases = [(case_high, 'high'), (case_low, 'low'), (case_outlier, 'outlier')]\n",
        "for idx, name in cases:\n",
        "    sv = shap_values[idx]\n",
        "    contrib = pd.Series(sv, index=feature_names).sort_values()\n",
        "    top_pos = contrib[contrib>0].sort_values(ascending=False).head(8)\n",
        "    top_neg = contrib[contrib<0].sort_values().head(8)\n",
        "    top = pd.concat([top_neg, top_pos])\n",
        "    plt.figure(figsize=(8,4))\n",
        "    top.plot(kind='barh')\n",
        "    plt.title(f'Local SHAP contributions (top) - case {name}')\n",
        "    plt.xlabel('SHAP value')\n",
        "    plt.tight_layout()\n",
        "    plt.savefig(f'plots/force_case_{name}.png', dpi=200)\n",
        "    plt.close()\n",
        "print('Saved local SHAP case plots')\n"
      ],
      "id": "WWsdfgL-fprg"
    },
    {
      "cell_type": "markdown",
      "source": [
        "Local-case dependence plots (high, low, outlier)"
      ],
      "metadata": {
        "id": "Fl8e65ckrFhg"
      },
      "id": "Fl8e65ckrFhg"
    },
    {
      "cell_type": "code",
      "source": [
        "\n",
        "case_indexes = {\n",
        "    \"high\": case_high,\n",
        "    \"low\": case_low,\n",
        "    \"outlier\": case_outlier\n",
        "}\n",
        "\n",
        "os.makedirs(\"plots/local_dependence_plots\", exist_ok=True)\n",
        "\n",
        "for name, idx in case_indexes.items():\n",
        "    shap_row = shap_vals[idx]\n",
        "\n",
        "    # Identify top positive and negative contributors for this record\n",
        "    contrib = pd.Series(shap_row, index=X_for_explain_df.columns).sort_values()\n",
        "\n",
        "    important_feats = list(contrib.head(3).index) + list(contrib.tail(3).index)\n",
        "\n",
        "    print(\"Local dependence features for\", name, \":\", important_feats)\n",
        "\n",
        "    for feat in important_feats:\n",
        "        if feat not in X_for_explain_df.columns:\n",
        "            continue\n",
        "\n",
        "        feat_idx = X_for_explain_df.columns.get_loc(feat)\n",
        "        x_axis_vals = X_for_explain_df[feat].values\n",
        "        y_axis_vals = shap_vals[:, feat_idx]\n",
        "\n",
        "        plt.figure(figsize=(7,5))\n",
        "        plt.scatter(x_axis_vals, y_axis_vals, s=10, alpha=0.6)\n",
        "        plt.xlabel(feat)\n",
        "        plt.ylabel(\"SHAP value\")\n",
        "        plt.title(f\"Dependence plot ({name} case): {feat}\")\n",
        "        plt.tight_layout()\n",
        "        plt.savefig(f\"plots/local_dependence_plots/dependence_{name}_{feat}.png\", dpi=200)\n",
        "        plt.close()\n",
        "\n",
        "print(\"Local dependence plots saved to: plots/local_dependence_plots/\")"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "EZ_DPfRvq2X8",
        "outputId": "d0a2178a-503a-411b-9c2e-9a480095f862"
      },
      "id": "EZ_DPfRvq2X8",
      "execution_count": 92,
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "Local dependence features for high : ['prior_claims', 'policy_deductible', 'vehicle_value', 'gender_F', 'age', 'vehicle_age']\n",
            "Local dependence features for low : ['vehicle_age', 'age', 'gender_M', 'vehicle_value', 'policy_deductible', 'prior_claims']\n",
            "Local dependence features for outlier : ['vehicle_age', 'age', 'gender_F', 'prior_claims', 'policy_deductible', 'gender_M']\n",
            "Local dependence plots saved to: plots/local_dependence_plots/\n"
          ]
        }
      ]
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "KipzArEjfprh"
      },
      "source": [
        "## 10. Bias analysis\n"
      ],
      "id": "KipzArEjfprh"
    },
    {
      "cell_type": "code",
      "execution_count": 93,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "bP_k6-KLfprh",
        "outputId": "cdd5491a-dccd-4bd4-da03-f040c8bfd0c1"
      },
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "Saved Bias_Analysis_report.txt\n"
          ]
        }
      ],
      "source": [
        "bias_report = []\n",
        "sensitive_candidates = [c for c in df.columns if c.lower() in ['gender', 'sex', 'marital_status', 'region']]\n",
        "for col in sensitive_candidates:\n",
        "    if col in X_test.columns:\n",
        "        groups = X_test[col].fillna('missing').unique()\n",
        "        rows = []\n",
        "        for g in groups:\n",
        "            mask = X_test[col].fillna('missing')==g\n",
        "            if mask.sum() < 5:\n",
        "                continue\n",
        "            rmse_g = np.sqrt(mean_squared_error(y_test[mask], y_pred[mask]))\n",
        "            mean_pred = y_pred[mask].mean()\n",
        "            rows.append({'group': g, 'n': int(mask.sum()), 'rmse': float(rmse_g), 'mean_pred': float(mean_pred)})\n",
        "        bias_report.append((col, rows))\n",
        "\n",
        "with open('reports/Bias_Analysis_report.txt', 'w') as f:\n",
        "    f.write('Bias and fairness checks (simple group residuals)\\n')\n",
        "    for col, rows in bias_report:\n",
        "        f.write(f'\\nAttribute: {col}\\n')\n",
        "        for r in rows:\n",
        "            f.write(f\"  group={r['group']}, n={r['n']}, rmse={r['rmse']:.6f}, mean_pred={r['mean_pred']:.6f}\\n\")\n",
        "print('Saved Bias_Analysis_report.txt')"
      ],
      "id": "bP_k6-KLfprh"
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "LvOFa65tfprh"
      },
      "source": [
        "## 11. Executive summary\n"
      ],
      "id": "LvOFa65tfprh"
    },
    {
      "cell_type": "code",
      "execution_count": 94,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "RB0BO_LFfprh",
        "outputId": "9813d83e-139e-4210-9f6b-18ebd2fc0f0b"
      },
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "Saved Executive_Summary.txt\n"
          ]
        }
      ],
      "source": [
        "exec_summary = []\n",
        "exec_summary.append('Executive Summary: Insurance Claim Severity Prediction')\n",
        "exec_summary.append('\\nModel: XGBRegressor in a sklearn Pipeline')\n",
        "exec_summary.append('\\nTrained model saved: artifacts/xgb_claim_severity_pipeline.joblib')\n",
        "exec_summary.append('\\nPredictions CSV: artifacts/predictions_test.csv')\n",
        "exec_summary.append('\\nGlobal SHAP CSV: artifacts/global_shap_importance.csv')\n",
        "exec_summary.append('\\nSHAP plots: plots/shap_summary_bar.png, plots/shap_summary_beeswarm.png')\n",
        "exec_summary.append('\\nLocal SHAP case plots: plots/force_case_high.png, plots/force_case_low.png, plots/force_case_outlier.png')\n",
        "with open('reports/Executive_Summary.txt', 'w') as f:\n",
        "    f.write('\\n'.join(exec_summary))\n",
        "print('Saved Executive_Summary.txt')\n"
      ],
      "id": "RB0BO_LFfprh"
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "p2KJZB9Ofprh"
      },
      "source": [
        "## 12. Checklist of generated files\n"
      ],
      "id": "p2KJZB9Ofprh"
    },
    {
      "cell_type": "code",
      "execution_count": 95,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "ftg7o1gFfprh",
        "outputId": "cc18d9ba-4975-495e-9857-37acac81465a"
      },
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "Files to include in submission:\n",
            " - ./artifacts/best_model_params.txt\n",
            " - ./artifacts/global_shap_importance.csv\n",
            " - ./artifacts/predictions_test.csv\n",
            " - ./artifacts/trained_model_config.txt\n",
            " - ./artifacts/xgb_claim_severity_pipeline.joblib\n",
            " - ./insurance_claims_large.csv\n",
            " - ./plots/dependence_plots/dependence_age.png\n",
            " - ./plots/dependence_plots/dependence_gender_F.png\n",
            " - ./plots/dependence_plots/dependence_gender_M.png\n",
            " - ./plots/dependence_plots/dependence_vehicle_age.png\n",
            " - ./plots/dependence_plots/dependence_vehicle_value.png\n",
            " - ./plots/force_case_high.png\n",
            " - ./plots/force_case_low.png\n",
            " - ./plots/force_case_outlier.png\n",
            " - ./plots/local_dependence_plots/dependence_high_age.png\n",
            " - ./plots/local_dependence_plots/dependence_high_gender_F.png\n",
            " - ./plots/local_dependence_plots/dependence_high_policy_deductible.png\n",
            " - ./plots/local_dependence_plots/dependence_high_prior_claims.png\n",
            " - ./plots/local_dependence_plots/dependence_high_vehicle_age.png\n",
            " - ./plots/local_dependence_plots/dependence_high_vehicle_value.png\n",
            " - ./plots/local_dependence_plots/dependence_low_age.png\n",
            " - ./plots/local_dependence_plots/dependence_low_gender_M.png\n",
            " - ./plots/local_dependence_plots/dependence_low_policy_deductible.png\n",
            " - ./plots/local_dependence_plots/dependence_low_prior_claims.png\n",
            " - ./plots/local_dependence_plots/dependence_low_vehicle_age.png\n",
            " - ./plots/local_dependence_plots/dependence_low_vehicle_value.png\n",
            " - ./plots/local_dependence_plots/dependence_outlier_age.png\n",
            " - ./plots/local_dependence_plots/dependence_outlier_gender_F.png\n",
            " - ./plots/local_dependence_plots/dependence_outlier_gender_M.png\n",
            " - ./plots/local_dependence_plots/dependence_outlier_policy_deductible.png\n",
            " - ./plots/local_dependence_plots/dependence_outlier_prior_claims.png\n",
            " - ./plots/local_dependence_plots/dependence_outlier_vehicle_age.png\n",
            " - ./plots/shap_summary_bar.png\n",
            " - ./plots/shap_summary_beeswarm.png\n",
            " - ./reports/Bias_Analysis_report.txt\n",
            " - ./reports/Executive_Summary.txt\n",
            " - ./reports/Model_Performance.txt\n"
          ]
        }
      ],
      "source": [
        "generated = []\n",
        "for root, dirs, files in os.walk('.'):\n",
        "    for fn in files:\n",
        "        if fn.endswith(('.png', '.csv', '.joblib', '.txt')):\n",
        "            generated.append(os.path.join(root, fn))\n",
        "print('Files to include in submission:')\n",
        "for g in sorted(generated):\n",
        "    print(' -', g)\n"
      ],
      "id": "ftg7o1gFfprh"
    },
    {
      "cell_type": "markdown",
      "source": [
        "conclusion:\n",
        "\n",
        "\n",
        "The XGBoost model successfully predicts claim severity with strong performance (RMSE ≈ 1569, R² ≈ 0.70), demonstrating reliable accuracy for insurance applications. SHAP analysis reveals that vehicle age, policyholder age, and demographic interactions are the primary drivers of model decisions, supported by meaningful dependence patterns. Local SHAP case studies highlight how feature interactions influence individual predictions, while bias analysis exposes areas requiring careful monitoring—such as demographic effects and sensitivity to rare combinations. Overall, the project delivers a transparent, interpretable, and operationally useful claim-severity model with insights that can guide underwriting, pricing, and risk management."
      ],
      "metadata": {
        "id": "BfWYJ6fhisTF"
      },
      "id": "BfWYJ6fhisTF"
    }
  ],
  "metadata": {
    "kernelspec": {
      "name": "python3",
      "display_name": "Python 3",
      "language": "python"
    },
    "language_info": {
      "name": "python"
    },
    "colab": {
      "provenance": []
    }
  },
  "nbformat": 4,
  "nbformat_minor": 5
}
